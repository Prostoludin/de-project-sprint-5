Витрина для расчетов с курьерами
1. Структура витрины
Наименование новой витрины - dm_courier_ledger. В таблице не должны повторяться поля (courier_id, settlement_year, settlement_month).
Витрина должна содержать следующие поля:
- id — идентификатор записи;
- courier_id — ID курьера, которому с которым осуществляется расчет;
- courier_name — Ф.И.О. курьера;
- settlement_year — год расчетного периода;
- settlement_month — месяц расчетного периода;
- orders_count — количество заказов за расчетный период (месяц);
- orders_total_sum — общая стоимость заказов за расчетный период;
- rate_avg — средний рейтинг курьера по оценкам пользователей;
- order_processing_fee — сумма, удержанная компанией за обработку заказов (25% от суммы заказа);
- courier_order_sum — сумма, которую необходимо перечислить курьеру за доставленные им/ей заказы в зависимости от его личного рейтинга.
- courier_tips_sum — сумма, которую пользователи оставили курьеру в качестве чаевых;
- courier_reward_sum — сумма, которую необходимо перечислить курьеру.

2. Список таблиц необходимых таблиц
Для новой витрины создан новый слой dds_project. Схема данного слоя - снежинка. Часть таблиц необходимо взять из ранее разработанного слоя dds, часть таблиц необходимо создать.
Для наполнения витрины потребуются следующие таблицы:
- dm_couriers — в таблице измерений собрана информация о курьерах: их id и ФИО. Таблицу необходимо создать;
- dm_delivery_ts — таблица измерений содержит информацию о времения доставки заказов. Таблицу необходимо создать;
- dm_deliveries — таблица измерений содержит информацию о доставке заказов. Таблицу необходимо создать;
- dm_order_ts — содержит измерений информацию о времени оформления заказов. Таблица скопирована из слоя dds с изменением имени;
- dm_orders — таблица измерений содержит информацию о совершенных заказах. Таблица скопирована из слоя dds с добавлением информации о времени доставки, курьере и id доставки;
- fct_order_delivery — таблица содержит информацию о фактах совершения заказа.

3. Загрузка информации из нового источника deliverysystem.
Источник содержит три таблицы: couriers, deliveries, restaurants.
Данные загружаются в stg слой as is. Для новой витрины потребуется загрузить следующую информацию:
- из таблицы couriers сущность courier, поля courier_id, courier_name;
- из талицы deliveries поля delivery_id, delivery_ts, courier_id, address, rate, sum и tip.
Информация о ресторанах из таблицы restaurants уже поступает из источника ordersystem и не требуется для новой витрины, поэтому загружать ее будем.